DROP DATABASE FLEET;
CREATE DATABASE FLEET;
USE FLEET;

CREATE TABLE MENU_DINAMICO(
   ID INT(2) PRIMARY KEY,
   NOMBRE VARCHAR(30) NOT NULL,
   URL VARCHAR(20) NOT NULL,
   ICONO VARCHAR(20)
);

INSERT INTO MENU_DINAMICO VALUES (0,"Dashboard","dashboard.php","pe-7s-graph");
INSERT INTO MENU_DINAMICO VALUES (1,"Estadisticas","estadisticas.php","pe-7s-calculator");

CREATE TABLE PLAN (
	PLAN INT(2) PRIMARY KEY,
    MONTO INT(10) NOT NULL,
    C_VEH INT(3) NOT NULL,
    C_ADM INT(1) NOT NULL,
    DESCR VARCHAR(20) NOT NULL
);

INSERT INTO PLAN VALUES (0,60000,50,2,"PLAN A");
INSERT INTO PLAN VALUES (1,70000,100,2,"PLAN A");

CREATE TABLE EMPRESA (
  EMPRESA INT(2) PRIMARY KEY,
  PLAN INT(2) NOT NULL,
  LOGO VARCHAR(40),
  NOMBRE VARCHAR(50),
  F_REG DATETIME NOT NULL,
  F_VEN DATETIME NOT NULL,
  CONSTRAINT FK_PLAN FOREIGN KEY (PLAN) REFERENCES PLAN (PLAN)
);

CREATE TABLE USUARIOS (
	RUT VARCHAR(10) PRIMARY KEY,
	PWD VARCHAR(32) NOT NULL,
    EMAIL VARCHAR(50) NOT NULL,
    COLOR VARCHAR(6),
    NOMBRE VARCHAR(20),
    APELLIDO VARCHAR(20),
    CARGO VARCHAR(20),
    PERMISO INT(1) NOT NULL,
    EMPRESA INT(2) NOT NULL,
    CONSTRAINT FK_EMPRESA FOREIGN KEY (EMPRESA) REFERENCES EMPRESA (EMPRESA)
);    

select * from usuarios;
select * from empresa;

insert into empresa values (0,0,"","RIVAS","2019-01-01","2020-01-01");
insert into usuarios values ("19359505-7","123456","matias@inacap.cl","000000","Matias","Rivas","Gerente General",0,0);

SELECT USUARIOS.RUT,USUARIOS.EMAIL,USUARIOS.COLOR,USUARIOS.NOMBRE,USUARIOS.APELLIDO,USUARIOS.CARGO,USUARIOS.PERMISO,EMPRESA.EMPRESA,EMPRESA.NOMBRE,EMPRESA.LOGO,EMPRESA.F_REG,EMPRESA.F_VEN FROM USUARIOS,EMPRESA WHERE USUARIOS.RUT="19359505-7" AND USUARIOS.PWD="123456" AND USUARIOS.EMPRESA=EMPRESA.EMPRESA;

CREATE TABLE ALERTAS (
	ID INT PRIMARY KEY,
    TITULO VARCHAR(20),
    MENSAJE VARCHAR(20),
    PERMISO INT(1) NOT NULL,
	EMPRESA INT(2) NOT NULL,
    CONSTRAINT FK_PER_EMP FOREIGN KEY (EMPRESA) REFERENCES EMPRESA (EMPRESA)
);